{% extends "base_timetable.html" %}
{% load static %}

{% block title %}Day Timetable {{ day }}.{{ month }}.{{ year }}{% endblock %}

{% block content %}
<body>
    <div class="grid-container">
        <div class="header">
            <h1>Timetable {{ day }}.{{ month }}.{{ year }}</h1>
        </div>
        <div class="calendar-settings">
            <form id="activityTypeForm" method="GET" hx-get="{% url 'timetable:update_timetable' timetable_id year month day %}" hx-indicator="#loading-indicator" hx-target="#grid-day">
                {% csrf_token %}
                {% for activity_type in activity_types %}
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="activity_types" value="{{ activity_type.id }}" id="activity_type{{ activity_type.id }}" onchange="document.getElementById('activityTypeForm').submit()" {% if activity_type.id in selected_activity_types %}checked{% endif %}>
                        <label class="form-check-label" for="activity_type{{ activity_type.id }}">
                            {{ activity_type.type_name }}
                        </label>
                    </div>
                {% endfor %}
            </form>
        </div>
        <div class="calendar-navigation">
                <form action="{% url 'timetable:display_day' timetable_id year month day %}" method="post">
                    {% csrf_token %}
                    <div class="btn-group">
                        <button type="submit" class="btn btn-info" formaction="{% url 'timetable:details' timetable_id %}">Return</button>
                        <button type="submit" class="btn btn-info" formaction="{% url 'timetable:display_month' timetable_id year month %} ">Month</button>
                        <button type="submit" class="btn btn-info" formaction="{% url 'timetable:display_week_for_day' timetable_id year %}" name="day_and_month" value={{day}}_{{month}}>Week</button>
                    </div>
                    <br>
                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary" name="change_value" value="-7"><<</button>
                        <button type="submit" class="btn btn-primary" name="change_value" value="-1"><</button>
                        <button type="submit" class="btn btn-primary" name="change_value" value="1">></button>
                        <button type="submit" class="btn btn-primary" name="change_value" value="7">>></button>
                    </div>
                </form>
        </div>
        <div class="grid-day" id="grid-day" hx-swap="outerHTML">
            {% include "timetable/modal_template.html" with modal_id="activityModal" modal_title="Activity details" modal_body_content="<strong>Activity: {{ activity.activity_id }}</strong><br>" modal_footer_content="" %}
            {% include "timetable/modal_template.html" with modal_id="activityTypeDetailsModal" modal_title="Activity type details" modal_body_content="<strong>Activity type: {{ activity.activity_type }}</strong><br>" modal_footer_content="" %}
            {% include "timetable/modal_template.html" with modal_id="courseDetailsModal" modal_title="Course details" modal_body_content="<strong>Course: {{ activity.course }}</strong><br>" modal_footer_content="" %}

                {% for time in timetable_times %}
                <div class="time-column" style="grid-row: {{time|date:'Hi'}}" >{{ time|date:'H:i'}}</div>
                {% endfor %}
                {% for track in activities %}
                {% for track in activities %}
                {% for activity in track %}
                <div class="activity" onclick="location.href='{% url 'timetable:activity_details' activity.id %}'" style="grid-row: {{activity.time_start|date:'Hi'}} / {{activity.time_end|date:'Hi'}}; grid-column: track{{ forloop.parentloop.counter }} / track{{ track_span }}; margin-top: 50 px; background-color: {{ activity.activity_type.type_color }}">
                    <strong><a href="{% url 'timetable:course_details' activity.course %}">{{ activity.course }}</a></strong> <br>
                    <a href="{% url 'timetable:activity_type_details' activity.activity_type %}">{{ activity.activity_type }}</a> <br>
                    {{ activity.time_start|date:'H:i' }} - {{ activity.time_end|date:'H:i' }} <br>
                    <p>{{ activity.description }}</p>
                </div>
                {% endfor %}
                {% endfor %}
                {% endfor %}
        </div>
    </div>
</body>
{% endblock %}


